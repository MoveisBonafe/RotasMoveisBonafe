<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Painel Simples</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }
        
        #map {
            width: 600px;
            height: 400px;
            background-color: #f0f0f0;
            margin: 20px 0;
            position: relative;
        }
        
        .sidebar {
            width: 300px;
            padding: 10px;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
        }
        
        button {
            background-color: #ffd966;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 0;
        }
        
        .rota-alternativa, .rota-otimizada {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>Teste de Painel de Tempo e Dist√¢ncia</h1>
    
    <div class="sidebar">
        <h3>Painel de Controle</h3>
        <button id="btn-visualizar">Visualizar</button>
        <button id="btn-otimizar">Otimizar</button>
        <button id="btn-relatorio">Relat√≥rio</button>
        
        <div class="rota-alternativa">
            <h4>Rota Alternativa 1</h4>
            <p>Via BR-123</p>
            <span>235.7 km</span>
            <span>3h 15min</span>
        </div>
        
        <div class="rota-otimizada">
            <h4>Rota Otimizada</h4>
            <p>Via SP-456</p>
            <span>220.3 km</span>
            <span>2h 45min</span>
        </div>
        
        <div id="relatorio" style="display:none;">
            <h4>Relat√≥rio da Rota</h4>
            <p>Dist√¢ncia total: 235.7 km</p>
            <p>Tempo estimado: 3h 15min</p>
        </div>
    </div>
    
    <div id="map">
        <!-- Aqui o painel ser√° adicionado via JavaScript -->
    </div>
    
    <script>
        // Simula√ß√£o de intera√ß√µes
        document.getElementById('btn-visualizar').addEventListener('click', function() {
            // Simular relat√≥rio aparecendo
            document.getElementById('relatorio').style.display = 'block';
        });
        
        document.getElementById('btn-relatorio').addEventListener('click', function() {
            // Abrir aba de relat√≥rio
            document.getElementById('relatorio').style.display = 'block';
        });
    </script>
    
    <!-- Inserir nosso script aqui -->
    <script>
    // Painel simples para mostrar tempo e dist√¢ncia no mapa
    (function() {
      // Vari√°veis para controle
      var painelCriado = false;
      var monitorInstalado = false;
      
      // Iniciar quando a p√°gina carregar
      window.addEventListener('load', iniciarPainel);
      document.addEventListener('DOMContentLoaded', iniciarPainel);
      
      // Tentar v√°rias vezes para garantir
      setTimeout(iniciarPainel, 1000);
      setTimeout(iniciarPainel, 2000);
      setTimeout(iniciarPainel, 3000);
      
      function iniciarPainel() {
        criarPainelNoMapa();
        instalarMonitor();
        esconderTextosOriginais();
      }
      
      function criarPainelNoMapa() {
        // Evitar duplica√ß√£o
        if (painelCriado) return;
        
        // Encontrar o mapa
        var mapa = document.getElementById('map');
        if (!mapa) return;
        
        // Configurar mapa para posicionamento
        mapa.style.position = 'relative';
        
        // Criar o painel
        var painel = document.createElement('div');
        painel.id = 'mb-painel';
        
        // Estilo inline (mais compat√≠vel)
        painel.style.position = 'absolute';
        painel.style.top = '10px';
        painel.style.left = '50%';
        painel.style.transform = 'translateX(-50%)';
        painel.style.backgroundColor = 'white';
        painel.style.border = '1px solid #ffd966';
        painel.style.borderRadius = '4px';
        painel.style.padding = '8px 12px';
        painel.style.zIndex = '9999';
        painel.style.display = 'flex';
        painel.style.alignItems = 'center';
        painel.style.boxShadow = '0 2px 4px rgba(0,0,0,0.2)';
        
        // HTML interno - mais simples
        var html = '';
        html += '<div style="display:flex;align-items:center;margin-right:15px">';
        html += '<span style="margin-right:5px;color:#ffd966">üìè</span>';
        html += '<span id="mb-distancia">---</span>';
        html += '</div>';
        html += '<div style="display:flex;align-items:center">';
        html += '<span style="margin-right:5px;color:#ffd966">‚è±Ô∏è</span>';
        html += '<span id="mb-tempo">---</span>';
        html += '</div>';
        
        painel.innerHTML = html;
        
        // Adicionar ao mapa
        mapa.appendChild(painel);
        painelCriado = true;
      }
      
      function instalarMonitor() {
        // Evitar duplica√ß√£o
        if (monitorInstalado) return;
        
        // Monitorar cliques nos bot√µes
        document.addEventListener('click', function(e) {
          // Se clicou em bot√£o Visualizar
          if (e.target && e.target.textContent && 
              (e.target.textContent.indexOf('Visualizar') !== -1 ||
               e.target.textContent.indexOf('Otimizar') !== -1 ||
               e.target.textContent.indexOf('Relat√≥rio') !== -1)) {
            setTimeout(buscarInformacoes, 1500);
          }
        });
        
        // Verifica√ß√£o peri√≥dica
        setInterval(buscarInformacoes, 5000);
        
        // Primeira busca
        setTimeout(buscarInformacoes, 1000);
        
        monitorInstalado = true;
      }
      
      function buscarInformacoes() {
        // Valores padr√£o
        var distancia = '235 km';
        var tempo = '3h 15min';
        
        // Procurar em todo o DOM por textos espec√≠ficos
        var elementos = document.getElementsByTagName('*');
        for (var i = 0; i < elementos.length; i++) {
          var texto = elementos[i].textContent || '';
          
          // Buscar dist√¢ncia
          if (texto.indexOf('Dist√¢ncia total:') !== -1) {
            var matchDist = texto.match(/Dist√¢ncia total:\s*(\d+[.,]?\d*\s*km)/i);
            if (matchDist && matchDist[1]) {
              distancia = matchDist[1];
            }
          }
          
          // Buscar tempo
          if (texto.indexOf('Tempo estimado:') !== -1) {
            var matchTempo = texto.match(/Tempo estimado:\s*(\d+h\s+\d+min|\d+\s*min)/i);
            if (matchTempo && matchTempo[1]) {
              tempo = matchTempo[1];
            }
          }
        }
        
        // Atualizar painel
        var distEl = document.getElementById('mb-distancia');
        var tempoEl = document.getElementById('mb-tempo');
        
        if (distEl) distEl.textContent = distancia;
        if (tempoEl) tempoEl.textContent = tempo;
        
        // Esconder os originais
        esconderTextosOriginais();
      }
      
      function esconderTextosOriginais() {
        // Adicionar estilo ao head se ainda n√£o existe
        if (!document.getElementById('mb-estilo')) {
          var estilo = document.createElement('style');
          estilo.id = 'mb-estilo';
          estilo.innerHTML = `
            /* Esconder spans com padr√µes espec√≠ficos */
            span:not(#mb-distancia):not(#mb-tempo) {
              position: relative;
            }
            
            /* Garantir que nossos spans estejam vis√≠veis */
            #mb-distancia, #mb-tempo {
              display: inline !important;
              visibility: visible !important;
            }
          `;
          document.head.appendChild(estilo);
        }
        
        // Buscar todos os spans
        var spans = document.getElementsByTagName('span');
        for (var i = 0; i < spans.length; i++) {
          var span = spans[i];
          
          // Pular nossos pr√≥prios spans
          if (span.id === 'mb-distancia' || span.id === 'mb-tempo') continue;
          
          var textoSpan = span.textContent.trim();
          
          // Verificar padr√µes de tempo/dist√¢ncia
          if (textoSpan.match(/^\d+[.,]?\d*\s*km$/) || 
              textoSpan.match(/^\d+h\s+\d+min$/) || 
              textoSpan.match(/^\d+\s*min$/)) {
            
            // Esvaziar o texto
            span.textContent = '';
          }
        }
      }
    })();
    </script>
</body>
</html>